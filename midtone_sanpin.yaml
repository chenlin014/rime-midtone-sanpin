zhuyin_to_midtone:
  __append:
    # 若無標明聲調、則默認爲是輕聲
    - xform/([a-zA-Z])(?=\b)/$15/

    # 尖音
    - derive/j([iv])/z$1/
    - derive/q([iv])/c$1/
    - derive/x([iv])/s$1/
    # 團音
    - xform/j([iv])/g$1/
    - xform/q([iv])/k$1/
    - xform/x([iv])/h$1/

    # ㄧㄛ同ㄧㄡ
    - derive/iU/io/
    # ㄧㄟ同ㄧㄝ
    - derive/iE/iI/
    # ㄨㄝ同ㄨㄟ
    - derive/uI/uE/
    # ㄨㄡ同ㄨㄛ
    - derive/uo/uU/
    # ㄩㄟ同ㄩㄝ
    - derive/vE/vI/

    # 聲母名調區
    # 用於輸入知吃等空韻字和的了等常用字
    - derive/([bpmf])o(?=\d)/$1名/
    - derive/([dtnlgkh])e(?=\d)/$1名/
    - xform/([ZCSrzcs])(?=\d)/$1名/

    # 把聲調放在聲母和韻母之間
    - xform/([iuvaoeEAIOUMNKGR]+)([1-5])$/$2$1/
    # 無聲母、有韻頭
    - xform/^([1-5][iuv][aoeEAIOUMNKGR]+)$/無$1/
    # 無聲母、無韻頭
    - xform/^([1-5])([aoeEAIOUMNKGR]+)$/$2韻$1/
    # 聲母加韻頭
    - xform/^([bpmfdtnlgkhjqxZCSrzcs][1-5][iuv])$/$1无/
    # 只有韻頭
    - xform/^([1-5][iuv])$/介$1/
    # 換成眞注音
    - 'xlit|bpmfdtnlgkhjqxZCSrzcsiuvaoeEAIOUMNKGR|ㄅㄆㄇㄈㄉㄊㄋㄌㄍㄎㄏㄐㄑㄒㄓㄔㄕㄖㄗㄘㄙㄧㄨㄩㄚㄛㄜㄝㄞㄟㄠㄡㄢㄣㄤㄥㄦ|'

    # -- 調區 --
    # 上排
    - xform/韻1/甲/
    - xform/韻2/乙/
    - xform/韻3/丙/
    - xform/韻4/丁/
    - xform/韻5/戊/
    - xform/5ㄨ/己/
    - xform/4ㄨ/庚/
    - xform/3ㄨ/辛/
    - xform/2ㄨ/壬/
    - xform/1ㄨ/癸/
    # 下排
    - xform/1ㄩ/子/
    - xform/2ㄩ/丑/
    - xform/3ㄩ/寅/
    - xform/4ㄩ/卯/
    - xform/5ㄩ/辰/
    - xform/名5/巳/
    - xform/名4/午/
    - xform/名3/未/
    - xform/名2/申/
    - xform/名1/酉/
    # 中排
    - xform/1ㄧ/壹/
    - xform/2ㄧ/貳/
    - xform/3ㄧ/叄/
    - xform/4ㄧ/肆/
    - xform/5ㄧ/伍/
    - xlit|54321|陸柒捌玖拾|

midtone_to_zhuyin:
  __append:
    # 上排
    - xform/甲/韻1/
    - xform/乙/韻2/
    - xform/丙/韻3/
    - xform/丁/韻4/
    - xform/戊/韻5/
    - xform/己/5ㄨ/
    - xform/庚/4ㄨ/
    - xform/辛/3ㄨ/
    - xform/壬/2ㄨ/
    - xform/癸/1ㄨ/
    # 下排     
    - xform/子/1ㄩ/
    - xform/丑/2ㄩ/
    - xform/寅/3ㄩ/
    - xform/卯/4ㄩ/
    - xform/辰/5ㄩ/
    - xform/巳/名5/
    - xform/午/名4/
    - xform/未/名3/
    - xform/申/名2/
    - xform/酉/名1/
    # 中排     
    - xform/壹/1ㄧ/
    - xform/貳/2ㄧ/
    - xform/叄/3ㄧ/
    - xform/肆/4ㄧ/
    - xform/伍/5ㄧ/
    - xlit|陸柒玖捌拾|54321|

    - xform/(ㄅ|ㄆ|ㄇ|ㄈ)名/$1ㄛ/
    - xform/(ㄉ|ㄊ|ㄋ|ㄌ|ㄍ|ㄎ|ㄏ)名/$1ㄜ/
    - xform/(ㄓ|ㄔ|ㄕ|ㄖ|ㄗ|ㄘ|ㄙ)名/$1/

    - xform/([1-5])(\S+)/$2$1/
    - xform/(?<!介)(ㄧ|ㄨ|ㄩ)([1-5])(?!无)/$2$1/
    - xform/(\S+)5$/5$1/
    - xform/(\S+)5 /5$1 /
    - xform/(5)(ㄧ|ㄨ|ㄩ)/$2$1/
    - xlit/12345/ˉˊˇˋ˙/

    - xform/无|韻//
    - xform/(介|無)(?=\S)//

    - xform/ㄧㄛ/ㄧㄡ/
    - xform/ㄧㄟ/ㄧㄝ/
    - xform/ㄨㄝ/ㄨㄟ/
    - xform/ㄨㄡ/ㄨㄛ/
    - xform/ㄩㄟ/ㄩㄝ/

    - xform/ㄗ(ㄧ|ㄨ|ㄩ)/ㄐ$1/
    - xform/ㄘ(ㄧ|ㄨ|ㄩ)/ㄑ$1/
    - xform/ㄙ(ㄧ|ㄨ|ㄩ)/ㄒ$1/
    - xform/ㄍ(ㄧ|ㄨ|ㄩ)/ㄐ$1/
    - xform/ㄎ(ㄧ|ㄨ|ㄩ)/ㄑ$1/
    - xform/ㄏ(ㄧ|ㄨ|ㄩ)/ㄒ$1/

# == 鍵盤佈局 ==

use_qwerty_layout:
  __append:
    # 聲母布局
    - xlit|ㄖㄔㄎㄊ＊＊ㄆㄘㄙ|qwertyuio|
    - xlit|ㄕㄓㄍㄉㄈㄏㄅㄗㄌ|asdfghjkl|
    - xlit|＊介無ㄋ＊＊ㄇ|zxcvbnm|
    # 韻母布局
    - xlit|ㄦㄞㄝㄛ|wuio|
    - xlit|ㄣㄥㄤㄢ＊ㄜㄚㄟㄡ无|asdfghjkl;|
    - xlit|ㄠ|m|
    # QWERTY
    - xlit|甲乙丙丁戊己庚辛壬癸|qwertyuiop|
    - xlit|壹貳叄肆伍陸柒捌玖拾|asdfghjkl;|
    - xlit|子丑寅卯辰巳午未申酉|zxcvbnm,./|

revert_qwerty:
  __append:
    # 運算輔助
    - xform/(\S+)/"$1"/

    # 無頭區
    - xform/(?<=")(.)q(?=")/Y1$1/
    - xform/(?<=")(.)w(?=")/Y2$1/
    - xform/(?<=")(.)e(?=")/Y3$1/
    - xform/(?<=")(.)r(?=")/Y4$1/
    - xform/(?<=")(.)t(?=")/Y5$1/

    # 恢復韻母
    - xform/(?<="\S\S)w(?=")/ㄦ/
    - xform/(?<="\S\S)u(?=")/ㄞ/
    - xform/(?<="\S\S)i(?=")/ㄝ/
    - xform/(?<="\S\S)o(?=")/ㄛ/

    - xform/(?<="\S\S)a(?=")/ㄣ/
    - xform/(?<="\S\S)s(?=")/ㄥ/
    - xform/(?<="\S\S)d(?=")/ㄤ/
    - xform/(?<="\S\S)f(?=")/ㄢ/
    - xform/(?<="\S\S)h(?=")/ㄜ/
    - xform/(?<="\S\S)j(?=")/ㄚ/
    - xform/(?<="\S\S)k(?=")/ㄟ/
    - xform/(?<="\S\S)l(?=")/ㄡ/
    - xform/(?<="\S\S);(?=")/无/

    - xform/(?<="\S\S)m(?=")/ㄠ/

    - xform/Y(\d)(\S+)/$2韻$1/

    # 恢復聲母
    - xform/(?<=")q/ㄖ/
    - xform/(?<=")w/ㄔ/
    - xform/(?<=")e/ㄎ/
    - xform/(?<=")r/ㄊ/
    - xform/(?<=")u/ㄆ/
    - xform/(?<=")i/ㄘ/
    - xform/(?<=")o/ㄙ/

    - xform/(?<=")a/ㄕ/
    - xform/(?<=")s/ㄓ/
    - xform/(?<=")d/ㄍ/
    - xform/(?<=")f/ㄉ/
    - xform/(?<=")g/ㄈ/
    - xform/(?<=")h/ㄏ/
    - xform/(?<=")j/ㄅ/
    - xform/(?<=")k/ㄗ/
    - xform/(?<=")l/ㄌ/

    - xform/(?<=")x/介/
    - xform/(?<=")c/無/
    - xform/(?<=")v/ㄋ/
    - xform/(?<=")m/ㄇ/

    # 移除運算輔助
    - xform/"//

    # 恢復通用鍵位名
    - xlit|qwertyuiop|甲乙丙丁戊己庚辛壬癸|
    - xlit|asdfghjkl;|壹貳叄肆伍陸柒捌玖拾|
    - xlit|zxcvbnm,./|子丑寅卯辰巳午未申酉|
