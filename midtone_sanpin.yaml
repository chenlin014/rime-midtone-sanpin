zhuyin_to_midtone:
  __append:
    # 尖音
    - derive/j([iv])/z$1/
    - derive/q([iv])/c$1/
    - derive/x([iv])/s$1/
    # 團音
    - xform/j([iv])/g$1/
    - xform/q([iv])/k$1/
    - xform/x([iv])/h$1/

    # ㄧㄛ同ㄧㄡ
    - derive/iU/io/
    # ㄧㄟ同ㄧㄝ
    - derive/iE/iI/
    # ㄨㄝ同ㄨㄟ
    - derive/uI/uE/
    # ㄨㄡ同ㄨㄛ
    - derive/uo/uU/
    # ㄩㄟ同ㄩㄝ
    - derive/vE/vI/

    # 聲母名調區
    # 用於輸入知吃等空韻字和的了等常用字
    - derive/([bpmf])o(?=\d)/$1名/
    - derive/([dtnlgkh])e(?=\d)/$1名/
    - xform/([ZCSrzcs])(?=\d)/$1名/

    # 把聲調放在聲母和韻母之間
    - xform/([iuvaoeEAIOUMNKGR]+)([1-5])$/$2$1/
    # 無聲有頭
    - xform/^([1-5][iuv][aoeEAIOUMNKGR]+)$/無$1/
    # 無聲無頭
    - xform/^([1-5])([aoeEAIOUMNKGR]+)$/$2韻$1/
    # 聲母加韻頭
    - xform/^([bpmfdtnlgkhjqxZCSrzcs][1-5][iuv])$/$1无/
    # 只有韻頭
    - xform/^([1-5][iuv])$/介$1/
    # 換成眞注音
    - 'xlit|bpmfdtnlgkhjqxZCSrzcsiuvaoeEAIOUMNKGR|ㄅㄆㄇㄈㄉㄊㄋㄌㄍㄎㄏㄐㄑㄒㄓㄔㄕㄖㄗㄘㄙㄧㄨㄩㄚㄛㄜㄝㄞㄟㄠㄡㄢㄣㄤㄥㄦ|'

    # -- 調區 --
    # 上排
    - xform/韻1/甲/
    - xform/韻2/乙/
    - xform/韻3/丙/
    - xform/韻4/丁/
    - xform/韻5/戊/
    - xform/5ㄨ/己/
    - xform/4ㄨ/庚/
    - xform/3ㄨ/辛/
    - xform/2ㄨ/壬/
    - xform/1ㄨ/癸/
    # 下排
    - xform/1ㄩ/子/
    - xform/2ㄩ/丑/
    - xform/3ㄩ/寅/
    - xform/4ㄩ/卯/
    - xform/5ㄩ/辰/
    - xform/名5/巳/
    - xform/名4/午/
    - xform/名3/未/
    - xform/名2/申/
    - xform/名1/酉/
    # 中排
    - xform/1ㄧ/壹/
    - xform/2ㄧ/貳/
    - xform/3ㄧ/叄/
    - xform/4ㄧ/肆/
    - xform/5ㄧ/伍/
    - xlit|54321|陸柒捌玖拾|

midtone_to_zhuyin:
  __append:
    # 上排
    - xform/甲/韻1/
    - xform/乙/韻2/
    - xform/丙/韻3/
    - xform/丁/韻4/
    - xform/戊/韻5/
    - xform/己/5ㄨ/
    - xform/庚/4ㄨ/
    - xform/辛/3ㄨ/
    - xform/壬/2ㄨ/
    - xform/癸/1ㄨ/
    # 下排     
    - xform/子/1ㄩ/
    - xform/丑/2ㄩ/
    - xform/寅/3ㄩ/
    - xform/卯/4ㄩ/
    - xform/辰/5ㄩ/
    - xform/巳/名5/
    - xform/午/名4/
    - xform/未/名3/
    - xform/申/名2/
    - xform/酉/名1/
    # 中排     
    - xform/壹/1ㄧ/
    - xform/貳/2ㄧ/
    - xform/叄/3ㄧ/
    - xform/肆/4ㄧ/
    - xform/伍/5ㄧ/
    - xlit|陸柒玖捌拾|54321|

    - xform/([ㄅㄆㄇㄈ])名/$1ㄛ/
    - xform/([ㄉㄊㄋㄌㄍㄎㄏ])名/$1ㄜ/
    - xform/([ㄓㄔㄕㄖㄗㄘㄙ])名/$1/

    - xform/介|无|韻|無//
    - xform/([1-4])(\S+)/$2$1/
    - xform/(\S+)5/5$1/
    - xlit/12345/ˉˊˇˋ˙/

    - xform/ㄧㄛ/ㄧㄡ/
    - xform/ㄧㄟ/ㄧㄝ/
    - xform/ㄨㄝ/ㄨㄟ/
    - xform/ㄨㄡ/ㄨㄛ/
    - xform/ㄩㄟ/ㄩㄝ/

    - xform/ㄗ([ㄧㄨ])/ㄐ$1/
    - xform/ㄘ([ㄧㄨ])/ㄑ$1/
    - xform/ㄙ([ㄧㄨ])/ㄒ$1/
    - xform/ㄍ([ㄧㄨ])/ㄐ$1/
    - xform/ㄎ([ㄧㄨ])/ㄑ$1/
    - xform/ㄏ([ㄧㄨ])/ㄒ$1/

# == 鍵盤佈局 ==

use_qwerty_layout:
  __append:
    # 聲母布局
    - xlit|ㄖㄔㄎㄊ＊＊ㄆㄘㄙ|qwertyuio|
    - xlit|ㄕㄓㄍㄉㄈㄏㄅㄗㄌ|asdfghjkl|
    - xlit|＊介無ㄋ＊＊ㄇ|zxcvbnm|
    # 韻母布局
    - xlit|ㄞㄝㄛ|uio|
    - xlit|ㄣㄥㄤㄢㄦㄜㄚㄟㄡ无|asdfghjkl;|
    - xlit|ㄠ|m|
    # QWERTY
    - xlit|甲乙丙丁戊己庚辛壬癸|qwertyuiop|
    - xlit|壹貳叄肆伍陸柒捌玖拾|asdfghjkl;|
    - xlit|子丑寅卯辰巳午未申酉|zxcvbnm,./|

revert_qwerty:
  __append:
    # 無聲無介
    - xform/(?<=\b)(.)q(?=\b)/韻1$1/
    - xform/(?<=\b)(.)w(?=\b)/韻2$1/
    - xform/(?<=\b)(.)e(?=\b)/韻3$1/
    - xform/(?<=\b)(.)r(?=\b)/韻4$1/
    - xform/(?<=\b)(.)t(?=\b)/韻5$1/

    # 恢復聲母
    - xform/(?<=\b)q/ㄖ/
    - xform/(?<=\b)w/ㄔ/
    - xform/(?<=\b)e/ㄎ/
    - xform/(?<=\b)r/ㄊ/
    - xform/(?<=\b)u/ㄆ/
    - xform/(?<=\b)i/ㄘ/
    - xform/(?<=\b)o/ㄙ/

    - xform/(?<=\b)a/ㄕ/
    - xform/(?<=\b)s/ㄓ/
    - xform/(?<=\b)d/ㄍ/
    - xform/(?<=\b)f/ㄉ/
    - xform/(?<=\b)g/ㄈ/
    - xform/(?<=\b)h/ㄏ/
    - xform/(?<=\b)j/ㄅ/
    - xform/(?<=\b)k/ㄗ/
    - xform/(?<=\b)l/ㄌ/

    - xform/(?<=\b)x/介/
    - xform/(?<=\b)c/無/
    - xform/(?<=\b)v/ㄋ/
    - xform/(?<=\b)m/ㄇ/

    # 恢復韻母
    - xform/(?<!介)u(?=\b)/ㄞ/
    - xform/(?<!介)i(?=\b)/ㄝ/
    - xform/(?<!介)o(?=\b)/ㄛ/

    - xform/(?<!介)a(?=\b)/ㄣ/
    - xform/(?<!介)s(?=\b)/ㄥ/
    - xform/(?<!介)d(?=\b)/ㄤ/
    - xform/(?<!介)f(?=\b)/ㄢ/
    - xform/(?<!介)g(?=\b)/ㄦ/
    - xform/(?<!介)h(?=\b)/ㄜ/
    - xform/(?<!介)j(?=\b)/ㄚ/
    - xform/(?<!介)k(?=\b)/ㄟ/
    - xform/(?<!介)l(?=\b)/ㄡ/
    - xform/(?<!介);(?=\b)/无/

    - xform/(?<!介)m(?=\b)/ㄠ/

    - xform/(韻\d)(.)/$2$1/

    # 恢復通用鍵位名
    - xlit|qwertyuiop|甲乙丙丁戊己庚辛壬癸|
    - xlit|asdfghjkl;|壹貳叄肆伍陸柒捌玖拾|
    - xlit|zxcvbnm,./|子丑寅卯辰巳午未申酉|
